
<app-navbar></app-navbar>
<div class="user-table-container">
  <h2>User Permissions</h2>
  
  <label for="table-select">Select Table:</label>
  
<select id="tableSelect" [(ngModel)]="selectedTable" (change)="onTableChange($event)"> <!--ngmodel is used for  selectbox to have the current selectedtabel even if we back form some other page strode in local storage -->
      <option *ngFor="let table in tables" [value]="table">{{ table }}</option>
  </select>

  <table>
    <thead>
      <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Email</th>
        <th>Insert</th>
        <th>Update</th>
        <th>Delete</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let user of currentTableData">
        <td>{{ user.UserId }}</td>
        <td>{{ user.name }}</td>
        <td>{{ user.email }}</td>
        <td>
          <button [disabled]="!isEditing" (click)="togglePermission(user, 'CanInsert')">
            {{ user.CanInsert ? '✔️' : '❌' }}
          </button>
        </td>
        <td>
          <button [disabled]="!isEditing" (click)="togglePermission(user, 'CanUpdate')">
            {{ user.CanUpdate ? '✔️' : '❌' }}
          </button>
        </td>
        <td>
          <button [disabled]="!isEditing" (click)="togglePermission(user, 'CanDelete')">
            {{ user.CanDelete ? '✔️' : '❌' }}
          </button>
        </td>
        <td>
          <!-- Display the "Save" button if in editing mode, otherwise display "Edit" -->
          <button *ngIf="isEditing" (click)="onSaveChanges()">Save</button>
          <button *ngIf="!isEditing" (click)="onEdit()">Edit</button>
        </td>
      </tr>
    </tbody>
  </table>

  <!-- Single Cancel button at the bottom right -->
  <div class="actions">
    <button *ngIf="isEditing" (click)="onCancelEdit()">Cancel</button>
  </div>

  <div class="alert">Your changes are saved!</div>
</div>
